# BEGIN WordPress
# The directives (lines) between "BEGIN WordPress" and "END WordPress" are
# dynamically generated, and should only be modified via WordPress filters.
# Any changes to the directives between these markers will be overwritten.
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
RewriteBase /alisodental/
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /alisodental/index.php [L]
</IfModule>
 
# END WordPress
 
# BEGIN WordPress Security
 
# Protect wp-config.php
<Files wp-config.php>
  Require all denied
</Files>
 
# Protect .htaccess itself
<Files .htaccess>
  Require all denied
</Files>
 
# Disable directory browsing
Options -Indexes
 
# Disable server signature
ServerSignature Off
 
# Protect sensitive files
<FilesMatch "\.(htaccess|htpasswd|ini|log|sh|bak|psd|git|svn|env)$">
  Require all denied
</FilesMatch>
 
# Prevent access to readme.html and license.txt
<FilesMatch "^(readme\.html|license\.txt|wp-config-sample\.php|robots\.txt|sitemap\.xml)$">
  Require all denied
</FilesMatch>
 
# Block XML-RPC if not needed
<Files xmlrpc.php>
  Require all denied
</Files>
 
# Disable PHP execution in uploads (relative path)
<FilesMatch "wp-content/uploads/.*\.php$">
  Require all denied
</FilesMatch>
 
# Secure headers
<IfModule mod_headers.c>
  Header always set X-Frame-Options "SAMEORIGIN"
  Header always set X-XSS-Protection "1; mode=block"
  Header always set X-Content-Type-Options "nosniff"
  Header always set Referrer-Policy "strict-origin-when-cross-origin"
  Header always set Permissions-Policy "geolocation=(), microphone=(), camera=()"
</IfModule>
 
# END WordPress Security
 
# =====================================================
 
# WordPress login protection (.htaccess)
 
# =====================================================
 
<IfModule mod_rewrite.c>
 
RewriteEngine On
 
# 1. Limits brute-force login attempts by blocking repeated POST requests to wp-login.php
 
RewriteCond %{REQUEST_URI} ^/wp-login\.php
 
RewriteCond %{REMOTE_ADDR} !^123\.123\.123\.123$ [NC] # 2. Allows unlimited access only from your IP
 
RewriteCond %{HTTP_COOKIE} !^.*wordpress_logged_in_.*$ [NC]
 
RewriteCond %{REQUEST_METHOD} POST
 
RewriteCond %{REQUEST_FILENAME} -f
 
RewriteCond %{REQUEST_URI} ^(.*)?wp-login\.php(.*)$ [NC]
 
# 3. Blocks empty user agents and known bad bots
 
RewriteCond %{HTTP_USER_AGENT} ^$ [OR]
 
RewriteCond %{HTTP_USER_AGENT} ^.*(curl|wget|bot|spider|crawler).*$ [NC]
 
RewriteRule .* - [F,L]
</IfModule>
 

# Extra protection: block access from bad bots
<IfModule mod_setenvif.c>
 
SetEnvIfNoCase User-Agent "libwww-perl" bad_bot
 
SetEnvIfNoCase User-Agent "python-requests" bad_bot
 
SetEnvIfNoCase User-Agent "curl" bad_bot
 
SetEnvIfNoCase User-Agent "wget" bad_bot
 
Order Allow,Deny
 
Allow from all
 
Deny from env=bad_bot
</IfModule>
 
 # ======================================
# Block robots.txt (returns 403 Forbidden)
# ======================================
<Files "robots.txt">
  Require all denied
</Files>
 
 
